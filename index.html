<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" media="screen" href="demo.css" type="text/css" />
    <title>Image Codec Comparison</title>
    <script async src="js/pica.min.js"></script>
</head>

<body style="max-width: 100%;">

    <div class="demo" style="margin-left: auto; margin-right: auto; overflow:hidden;">
        <table>
            <tr>
                <td class="title" colspan=3>
                    <select id="subsetSel" style="font-size: 1.1em; margin-bottom: 1em;">
                    </select>
                </td>
            </tr>
            <tr>
                <td class="title" colspan=3>
                    <select id="fileSel" style="font-size: 1.1em; margin-bottom: 1em;">
                    </select>
                </td>
            </tr>
            <tr>
                <td class="title" style="width:16em;padding-left:4em;text-align:right;">
                    <select id="leftSel" style="font-size: 1.1em;">
                    </select>
                    <select id="leftQual" style="font-size: 1.1em;">
                        <option value="l">Large</option>
                        <option value="m">Medium</option>
                        <option value="s" selected>Small</option>
                        <option value="t">Tiny</option>
                    </select>
                </td>
                <td class="center-head" id="center-head">
                    --- vs ---
                </td>
                <td class="title" style="width:16em;padding-right:4em;text-align:left;">
                    <select id="rightSel" style="font-size: 1.1em;">
                    </select>
                    <select id="rightQual" style="font-size: 1.1em;">
                        <option value="l">Large</option>
                        <option value="m">Medium</option>
                        <option value="s" selected>Small</option>
                        <option value="t">Tiny</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td colspan=3 style="padding-top: 1em; padding-bottom: 1em;">
                    <div id="rightContainer" style="margin-left: auto; margin-right: auto; position: relative; width:800px; height:800px;">
                        <div id="leftContainer" style="border-right: 1px dotted white; width:800px; height:800px;"></div>
                        <div id="leftText" style="position: absolute; color: white; padding:.2em .5em .2em .5em;"></div>
                        <div id="rightText" style="position: absolute; color: white; padding:.2em .5em .2em .5em;"></div>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="title" colspan="3" style="width: 20%; text-align: center; padding-bottom: 1.25em;">
                    <select id="scaleSel" style="width:5em ;font-size: 1em;text-align:center;">
                        <option ratio="1:3" value="0.5773502692">1/3</option>
                        <option ratio="1:2" value="0.7071067812">1/2</option>
                        <option ratio="1:1" value="1" selected>---</option>
                        <option ratio="2:1" value="1.414213562">2x</option>
                        <option ratio="3:1" value="1.732050808">3x</option>
                    </select>
                </td>
            </tr>
        </table>
    </div>
    <div class="caption">
        <h1>image-formats-comparision</h1>
        <h2>Notes</h2>
        <p>Each image size is targeting a constant bits per pixel data density in order to get a range of quality levels from different images at each size. Each size is a particular fraction of a uncompressed (24 BPP) image. The "Large" size targets 5% of the uncompressed size (24/20 = 1.2 BPP). Medium targets half the size of Large, Small half the size of Medium, and Tiny half the size of Small.</p>
        <p>The results from JPEG XL are a bit complicated because the -q mode of the program is a hybrid between normal mode and modular mode, so you're seeing two different modes of operation (transparently) depending on what the quality level is. There's some chance that the behavior isn't monotonic, so the results may be a little strange, but it should be okay at high quality levels and it's better than the alternative (which was previously only using the normal mode).</p>
        <p>Rescaling in the web page (when needed) is through Lanczos2.</p>
        <p>This page is based on <a href="http://people.xiph.org/~xiphmont/demo/daala/update1-tool2b.shtml" target="_blank">Xiph.org's</a> Daala comparison page. <a href="https://github.com/xooyoozoo/yolo-octo-bugfixes" target="_blank">Originally developed by xooyoozoo</a>. This version is a clean fork of <a href="https://wyohknott.github.io/image-formats-comparison/" target="_blank">Wyohknott's improved version</a> with additional updates and modifications.
        <p>A list of sources for the images can be found in <a href="https://afontenot.github.io/image-formats-comparison/cite_images.txt" target="_blank">this text file</a>.</p>
        <p>Last updated: April 2021.</p>
        <h2>Changes</h2>
        <ul>
            <li>Instead of using the original Daala test images, which are 4:2:0 subsampled, I recreated the image set from the original high-res sources, downscaling to the same sized source images as the Daala set, but not subsampled (4:4:4). This fixes <a href="https://github.com/WyohKnott/image-formats-comparison/issues/4" target="_blank">this bug</a>.</li>
            <li>I wrote my own script for generating the comparison images which uses a binary search to quickly find the quality level that generates the image with the closest file size to the target. You can find that here: <a href="https://github.com/afontenot/image-formats-comparison" target="_blank">here</a>. This fixes <a href="https://github.com/WyohKnott/image-formats-comparison/issues/1">this issue</a>.</li>
            <li><b>All</b> images that can't be rendered by the browser are now served as PNGs, instead of trying (in some cases) to decode with Javascript. The images were heavily compressed (losslessly) to take up less space, and this requires less decoding power on the viewer end. This change also fixes <a href="https://github.com/WyohKnott/image-formats-comparison/issues/10" target="_blank">this bug</a> and also <a href="https://github.com/WyohKnott/image-formats-comparison/issues/11" target="_blank">this one</a>.</li>
            <li>A number of codecs from the previous version were dropped. These are Daala, KDU (JPEG2000), OpenJpeg (JPEG2000), PIK, VP9, and WebP. WebP was dropped because it doesn't support unsubsampled images, making it a bad candidate for a high quality photography codec. PIK was dropped because I couldn't get it running on my computer; I think it might require newer CPU features. I'd like to add it back in the future if possible. OpenJpeg was removed because the results seemed to be fairly low quality. KDU was removed because it crashed on input images with certain characters in the filename. I might work on adding it back later. As for Daala and VP9, I think their features have been mostly subsumed into newer codecs that current development effort is focused on.</li>
            <li><b>JPEGXL</b> was added to the comparison.</li>
            <li>All codecs were updated to their latest available releases, see below. This fixes <a href="https://github.com/WyohKnott/image-formats-comparison/issues/8" target="_blank">this issue</a>.</li>
            <li>I fixed a bug where the settings weren't restored from the URL when refreshing or sharing a link.</li>
            <li>I fixed a bug that caused images to frequently have incorrect bits / pixel calculations.</li>
        </ul>
        <h2>Versions and Commands</h2>
        <p><b>AV1 (aom reference encoder 3.0.0):</b></p>
        <p><pre>aomenc --i444 --passes=2 --end-usage=q --cq-level={quality} --ivf -o {output.ivf} {input.y4m}</pre></p>
        <p><b>BPG (libbpg 0.9.8):</b></p>
        <p><pre>bpgenc -m 9 -f 444 -q {quality} -o {output.bpg} {input.png}</pre></p>
        <p><b>FLIF (FLIF 0.3):</b></p>
        <p><pre>flif -E 95 -Q {quality} {input.png} {output.flif}</pre></p>
        <p><b>JPEGXL (libjpeg-xl git:ab7c5e9b 2021-04-21):</b></p>
        <p><pre>cjxl -s 9 -q {quality} {input.png} {output.jxl}</pre></p>
        <p><b>JPEGXR (jxrlib 0.2.1):</b></p>
        <p><pre>JxrEncApp -d 3 -q {quality} -o {output.jxr} -i {input.ppm}</pre></p>
        <p><b>MozJPEG (mozjpeg 4.0.3):</b></p>
        <p><pre>cjpeg -sample 1x1 -quality {quality} -outfile {output.jpg} {input.png}</pre></p>
    </div>

    <!-- scripts that need to access the DOM are loaded below -->
    <script src="js/splitimage2.js"></script>

  </body>
</html>
